# Detailed Workflow

## 1. 既存スキルの読み込み

まず現在利用可能なスキルを把握：

```
Glob: ~/.claude/skills/*/SKILL.md
Glob: ~/.claude/skills/**/skill.md
Glob: .claude/skills/*/SKILL.md (プロジェクト内)
```

各スキルの以下を確認：
- **name**: スキル名
- **description**: トリガーと目的
- **allowed-tools**: 使用ツール

## 2. スキル使用状況の分析

セッション内でのスキル活用を評価：

### A. 使用されたスキル

| スキル名 | 使用回数 | 成功率 | 備考 |
|----------|----------|--------|------|
| {skill} | {N}回 | {%} | {コメント} |

**評価観点**:
- トリガーが適切に機能したか
- ワークフローが期待通りに進んだか
- ユーザーの期待と結果が一致したか

### B. 使用されなかったスキル（使用機会があった）

| スキル名 | 使用機会 | 不使用の理由 |
|----------|----------|--------------|
| {skill} | {場面} | {理由} |

**よくある理由**:
- トリガーのdescriptionが不十分
- ユーザーの言い回しとマッチしなかった
- スキルの存在を認識できなかった

### C. スキルがなく手動で行った作業

| 作業内容 | 発生回数 | スキル化の候補 |
|----------|----------|----------------|
| {作業} | {N}回 | {Yes/No} |

## 3. 並列化の分析

サブエージェント（Task）の使用状況を評価：

### 並列実行の状況

| 場面 | 並列化 | 効果 | 改善案 |
|------|--------|------|--------|
| {場面} | {Yes/No} | {効果} | {改善案} |

**評価観点**:
- 並列化すべき場面で並列化できていたか
- 不要な並列化をしていなかったか
- サブエージェントへの指示は適切だったか

### 並列化の機会損失

```
- {並列化すべきだった場面1}
- {並列化すべきだった場面2}
```

### 不適切な並列化

```
- {順序依存があったのに並列化した場面}
- {単純なタスクを不要に委譲した場面}
```

## 4. エラー・ミスパターンの分析

### 繰り返し発生したエラー

| エラー内容 | 発生回数 | 根本原因 | 対策 |
|------------|----------|----------|------|
| {エラー} | {N}回 | {原因} | {対策} |

### ユーザーからの修正指示

| 修正内容 | 回数 | スキル/CLAUDE.md改善 |
|----------|------|----------------------|
| {修正} | {N}回 | {改善案} |

## 5. 改善提案の作成（優先度順）

### 高優先度：既存スキルの改善

**フォーマット**:
```markdown
## スキル改善: {skill-name}

**現状の問題**:
- {問題点}

**改善案**:
- {具体的な改善内容}

**変更箇所**:
- {ファイル}: {変更内容}

**期待効果**:
- {効果}
```

### 中優先度：新規スキルの提案

**フォーマット**:
```markdown
## 新規スキル提案: {skill-name}

**背景**: {なぜ必要か - セッション内の具体例}

**トリガー**: {発動する言い回し}

**ワークフロー概要**:
1. {ステップ}

**必要なツール**: {allowed-tools}
```

### 低優先度：CLAUDE.md追記

**フォーマット**:
```markdown
## CLAUDE.md追記提案

**追記理由**: {繰り返しミスの防止など}

**追記内容**:
{テキスト}

**分類**: {プロジェクト固有 / 汎用}
```

## 6. レポート出力

```markdown
# セッション分析レポート

## サマリー
- セッション概要: {何をしたか}
- スキル使用: {N}種類のスキルを使用
- 並列化: {評価}
- 改善提案: {件数}

## スキル使用状況

### よく機能したスキル
{スキル名と評価}

### 改善が必要なスキル
{スキル名と問題点}

### 使用機会を逃したスキル
{スキル名と場面}

## 並列化の評価
{並列化の状況と改善点}

## エラー・ミスパターン
{パターンと対策}

## 改善提案（優先度順）

### 高優先度：スキル改善
{提案}

### 中優先度：新規スキル
{提案}

### 低優先度：CLAUDE.md
{提案}

## 次のアクション
1. {アクション}
```

## 7. ユーザーへの確認

- どの改善を実行するか
- スキル改善の方向性は正しいか
- 優先度の調整が必要か
