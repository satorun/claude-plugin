---
name: analyzing-session-patterns
description: セッションを振り返り、スキルの使用状況・改善点・並列化の効率を分析する。「このセッションを振り返って」「振り返りをして」「セッションを分析して」「改善点ある？」と言われたときに使用。
allowed-tools:
  - Read
  - Write
  - Glob
  - Grep
---

# Analyzing Session Patterns

セッションを分析し、**スキルの使用状況と改善機会**を特定する。既存スキルの効果測定、改善提案、新規スキルの必要性判断を行う。

## When to Use

Use this skill when:
- 「このセッションを振り返って」
- 「振り返りをして」
- 「セッションを分析して」
- 「改善点ある？」
- 「スキルの効果を確認して」

## Workflow

### 1. 既存スキルの読み込み

まず現在利用可能なスキルを把握：

```
Glob: ~/.claude/skills/*/SKILL.md
Glob: ~/.claude/skills/**/skill.md
Glob: .claude/skills/*/SKILL.md (プロジェクト内)
```

各スキルの以下を確認：
- **name**: スキル名
- **description**: トリガーと目的
- **allowed-tools**: 使用ツール

### 2. スキル使用状況の分析

セッション内でのスキル活用を評価：

#### A. 使用されたスキル

| スキル名 | 使用回数 | 成功率 | 備考 |
|----------|----------|--------|------|
| {skill} | {N}回 | {%} | {コメント} |

**評価観点**:
- トリガーが適切に機能したか
- ワークフローが期待通りに進んだか
- ユーザーの期待と結果が一致したか

#### B. 使用されなかったスキル（使用機会があった）

| スキル名 | 使用機会 | 不使用の理由 |
|----------|----------|--------------|
| {skill} | {場面} | {理由} |

**よくある理由**:
- トリガーのdescriptionが不十分
- ユーザーの言い回しとマッチしなかった
- スキルの存在を認識できなかった

#### C. スキルがなく手動で行った作業

| 作業内容 | 発生回数 | スキル化の候補 |
|----------|----------|----------------|
| {作業} | {N}回 | {Yes/No} |

### 3. 並列化の分析

サブエージェント（Task）の使用状況を評価：

#### 並列実行の状況

| 場面 | 並列化 | 効果 | 改善案 |
|------|--------|------|--------|
| {場面} | {Yes/No} | {効果} | {改善案} |

**評価観点**:
- 並列化すべき場面で並列化できていたか
- 不要な並列化をしていなかったか
- サブエージェントへの指示は適切だったか

#### 並列化の機会損失

```
- {並列化すべきだった場面1}
- {並列化すべきだった場面2}
```

#### 不適切な並列化

```
- {順序依存があったのに並列化した場面}
- {単純なタスクを不要に委譲した場面}
```

### 4. エラー・ミスパターンの分析

#### 繰り返し発生したエラー

| エラー内容 | 発生回数 | 根本原因 | 対策 |
|------------|----------|----------|------|
| {エラー} | {N}回 | {原因} | {対策} |

#### ユーザーからの修正指示

| 修正内容 | 回数 | スキル/CLAUDE.md改善 |
|----------|------|----------------------|
| {修正} | {N}回 | {改善案} |

### 5. 改善提案の作成（優先度順）

#### 高優先度：既存スキルの改善

**フォーマット**:
```markdown
## スキル改善: {skill-name}

**現状の問題**:
- {問題点}

**改善案**:
- {具体的な改善内容}

**変更箇所**:
- {ファイル}: {変更内容}

**期待効果**:
- {効果}
```

#### 中優先度：新規スキルの提案

**フォーマット**:
```markdown
## 新規スキル提案: {skill-name}

**背景**: {なぜ必要か - セッション内の具体例}

**トリガー**: {発動する言い回し}

**ワークフロー概要**:
1. {ステップ}

**必要なツール**: {allowed-tools}
```

#### 低優先度：CLAUDE.md追記

**フォーマット**:
```markdown
## CLAUDE.md追記提案

**追記理由**: {繰り返しミスの防止など}

**追記内容**:
{テキスト}

**分類**: {プロジェクト固有 / 汎用}
```

### 6. レポート出力

```markdown
# セッション分析レポート

## サマリー
- セッション概要: {何をしたか}
- スキル使用: {N}種類のスキルを使用
- 並列化: {評価}
- 改善提案: {件数}

## スキル使用状況

### よく機能したスキル
{スキル名と評価}

### 改善が必要なスキル
{スキル名と問題点}

### 使用機会を逃したスキル
{スキル名と場面}

## 並列化の評価
{並列化の状況と改善点}

## エラー・ミスパターン
{パターンと対策}

## 改善提案（優先度順）

### 高優先度：スキル改善
{提案}

### 中優先度：新規スキル
{提案}

### 低優先度：CLAUDE.md
{提案}

## 次のアクション
1. {アクション}
```

### 7. ユーザーへの確認

- どの改善を実行するか
- スキル改善の方向性は正しいか
- 優先度の調整が必要か

## Examples

### Example 1: スキルのトリガー改善

**分析結果**:
```markdown
## スキル改善: starting-jira-task

**現状の問題**:
- 「このチケットから始めて」と言われた際に発動しなかった
- descriptionに「チケットから始めて」がトリガーとして含まれていない

**改善案**:
- descriptionにトリガーパターンを追加

**変更箇所**:
- SKILL.md: description行に「チケットから始めて」を追加

**期待効果**:
- より自然な言い回しでスキルが発動
```

### Example 2: 並列化の改善提案

**分析結果**:
```markdown
## スキル改善: orchestrating-development-tasks

**現状の問題**:
- 調査タスクとビルドタスクを順次実行していた
- 並列化すれば時間短縮できた

**改善案**:
- 並列実行可能なタスクの判定ロジックを追加
- reference/に並列化判断ガイドを追加

**期待効果**:
- 独立したタスクの並列実行による効率化
```

### Example 3: スキル使用機会の損失

**分析結果**:
```markdown
## スキル改善: pr-comment-response

**現状の問題**:
- PRコメント対応の場面でスキルが発動しなかった
- ユーザーは「レビューコメントを確認して」と言った
- descriptionに「レビューコメント」が含まれていない

**改善案**:
- descriptionに「レビューコメント」「PRのコメント」を追加

**変更箇所**:
- SKILL.md: descriptionを更新
```

## Error Handling

### セッションが短い場合
- **対応**: 「セッションが短いため、スキルの使用状況を十分に評価できませんでした」と報告
- 可能な範囲で分析を提供

### スキルが一切使われなかった場合
- **対応**: 手動で行った作業を分析し、スキル化の候補を提案

## Best Practices

- **スキル改善を最優先**: 既存スキルの改善は新規作成より効果的
- **トリガーの多様性**: 様々な言い回しでスキルが発動するよう改善
- **並列化の適切さ**: 過剰でも不足でもない適切な並列化を評価
- **具体的な根拠**: セッション内の具体例を引用して提案
- **実行可能な提案**: すぐに適用できる形で改善案を提示

## Notes

- このスキルはスキル改善に焦点を当てる
- 実際のスキル作成・編集は`creating-skills`スキルを使用
- 分析はセッションコンテキストに基づく
- 長期的なパターンは複数セッションの振り返りが必要

## Related Skills

- **creating-skills**: スキルの新規作成・編集
- **orchestrating-tasks**: サブエージェントの活用
